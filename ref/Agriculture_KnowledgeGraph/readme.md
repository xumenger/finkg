项目地址[https://github.com/xumenger/Agriculture_KnowledgeGraph](https://github.com/xumenger/Agriculture_KnowledgeGraph)

>农业知识图谱：农业领域的信息检索、命名实体识别、关系抽取、分类树构建、数据挖掘

## 农业知识图谱介绍

#### 可复用资源

* hudong_pedia.csv：已经爬好的农业实体的百科页面的结构化csv文件
* labels.txt：5000多个手工标注的实体类别
* predict_labels.txt：KNN算法预测的13W多个实体的类别
* /wikidataSpider/wikidataProcessing/wikidata_relation.csv
	* predict_labels.txt实体在wikidata中对应的三元组关系
* attributes.csv：部分实体的属性（互动百科页面中直接得到）

#### 图谱实体获取

* 根据19000条农业网词条，按照筛选法提取名词
	* 分批进行，每2000条1批
	* 每批维护一个不可重集合
* 将9批词作交集，生成农业词典
* 将词典中的词在互动百科中进行爬取，抛弃不存在的页面，提取页面内容，存到数据库中
* 根据页面内容，提取每个词条页面的特征，构造相似度的比较方法，使用KNN进行分类
* 最后获取每个词条的所属类别，同时能够剔除不属于农业的无关词条

#### 命名实体识别

使用thulac工具进行分词、词性标注、命名实体识别（仅人名、地名、机构名）为了识别农业领域特定实体，我们需要：

* 分词、词性标注、命名实体识别
* 已识别为命名实体（person、location、organzation）的，若实体库没有，可以标注出来
* 对于非命名实体部分，采用一定的词组合和词性规则，在O(N)时间扫描所有分词，过滤掉不可能为农业实体的部分（例如动词肯定不是农业实体）
* 对于剩余词及词组合，匹配知识库中已分好类的实体。如果没有匹配到实体，或者匹配到的实体属于0类（即非实体类），则将其过滤掉
* 实体的分类算法见下文

#### 命名实体的分类

| Label | NE Tags                                                         | Example                                  
| ----- | --------------------------------------------------------------- | ------------------------------------------------------------------------
| 0     | Invalid（不合法）                                                | “色调”，“文化”，“景观”，“条件”，“A”，“234年”（不是具体的实体，或一些脏数据）
| 1     | Person（人物，职位）                                              | “袁隆平”，“习近平”，“皇帝”
| 2     | Location（地点，区域）                                            | “福建省”，“三明市”，“大明湖”
| 3     | Organization（机构，会议）                                        | “华东师范大学”，“上海市农业委员会”                      
| 4     | Political economy（政治经济名词）                                 | “惠农补贴”，“基本建设投资”
| 5     | Animal（动物学名词，包括畜牧类，爬行类，鸟类，鱼类，等）               | “绵羊”，“淡水鱼”，“麻雀”
| 6     | Plant（植物学名词，包括水果，蔬菜，谷物，草药，菌类，植物器官，其他植物） | “苹果”，“小麦”，“生菜”
| 7     | Chemicals（化学名词，包括肥料，农药，杀菌剂，其它化学品，术语等）       | “氮”，“氮肥”，“硝酸盐”，“吸湿剂”
| 8     | Climate（气候，季节）                                             | “夏天”，“干旱”                  
| 9     | Food items（动植物产品）                                          | “奶酪”，“牛奶”，“羊毛”，“面粉”
| 10    | Diseases（动植物疾病）                                            | “褐腐病”，“晚疫病”
| 11    | Natural Disaster（自然灾害）                                      | “地震”，“洪水”，“饥荒”
| 12    | Nutrients（营养素，包括脂肪，矿物质，维生素，碳水化合物等）            | “维生素A”，"钙"                               
| 13    | Biochemistry（生物学名词，包括基因相关，人体部位，组织器官，细胞，细菌，术语） | “染色体”，“血红蛋白”，“肾脏”，“大肠杆菌”
| 14    | Agricultural implements（农机具，一般指机械或物理设施）              | “收割机”，“渔网”
| 15    | Technology(农业相关术语，技术和措施)                                | “延后栽培"，“卫生防疫”，“扦插”
| 16    | other（除上面类别之外的其它名词实体，可以与农业无关但必须是实体）        | “加速度"，“cpu”，“计算机”，“爱鸟周”，“人民币”，“《本草纲目》”，“花岗岩”

## 构建知识图谱的思路

#### 手工构造labels.txt

在labels.txt中整理了类别实体的典型词语，按照上面列出的需要的实体类别，分别人工整理出一些典型的实体词语

分别有：

1. 时间：1949年、道光十四年、公元77年、崇祯七年、灾年等。共979-0个词
2. 数字：1983、三八、63、二、三九一一、175等。共1139-980个词
3. 人物：胡琴、郭氏、王正国、王蓉等。共1240-1140个词
4. 地点：温县、克什米尔地区、县市、英国、冷寒地带、日照市、中非共和国等。共1466-1241个词
5. 大学、公司等机构：班加罗尔大学、南安普顿大学、香港大学、Intel公司、北京农学院、中国水产总公司等。共1935-1467个词
6. 专用名词：比例税率、税法、矿业政策、税务机关、计划经济、渔税、经济联合体、社会主义经济等。共2139-1936个词
7. 动物：授粉昆虫、福寿鱼、雄鱼、牛、三宝鸟、珍珠鸡、牧牛等。共2544-2140个词
8. 植物：金佛草、青菜、霸王花、麦子、桂花、水苋菜、石头花等。共2830-2545个词
9. 化学品：保存剂、鱼盐、芥子气、土杂肥、一氧化氮、丙烯酸树脂胶粘剂、钡盐等，共2936-2830个词
10. 气象：烟雾、台风雨、水旱、秋天、冬天、冻雨、蛮烟瘴雨、雪灾等。共3021-2936个词
11. 农副产品：桑杏汤、牛奶、烤鱼片、奶油、毛衣、动物饼干、北京酱菜、大豆酱等。共3076-3022个词
12. 疾病：葡萄蔓枯病、夏病、白肌病、脂血病、鳃霉病、禽曲霉菌病等。共3197-3076个词
13. 灾害：泥石流、水土流失、地震、洪水、臭氧层、热带气旋、鼠害等。共3250－3197个词
14. 营养素：脂溶性维生素、营养钵育苗、高级脂肪酸、必需脂肪酸等。共3314-3250个词
15. 生物名词：染色体、DNA、遗传、心脏、脾脏、鼻子、腿毛、胰腺等。共3422-3314个词
16. 物理设备：小型计算机、粉碎机、绞肉机、数据库计算机、镰刀等。共3527-3422个词
17. 农业术语：卫生防疫、嫁接法、无土栽培、防疫站等。共3564-3528个词
18. 其他1：生产层、丝麻、岗山、黄香草木樨、遵化、军事科学、血吸虫病、电机、等。共3751－3565个词
19. 其他2：舒州、瘤细胞、牧马、手术疗法、窝、下午、硝基化合物、风泵、庐山云雾等。共－3752个词

先根据领域内专业经验确定最初的专有名词，其他的可以在开发过程中慢慢手工添加

>那么做金融(债券)领域的知识图谱也是一样，首先要手工构造一份金融领域的实体词典

>至少需要这些类别：时间、数字、地点（北京、杭州、东北等）、机构（公司、基金公司、证券公司、交易所、恒生电子、温州皮革厂等）、债券/基金/股票代码（600570等）、债券名词/专业名词（国债、信用债、利率、违约等）、人物（公司高管、刘曙峰、彭政刚等）、其他（离职、开除、等）

>更多的类别、类别实体名词请后续根据开发补充

>还有一个问题，predict_labels.txt中的内容是KNN算法预测的13W多个实体的类别，但是具体是怎么样的步骤呢？

#### hudong_pedia.csv

已经爬好的农业实体的百科页面的结构化csv文件

其格式是这样的

```csv
"title","url","image","openTypeList","detail","baseInfoKeyList","baseInfoValueList"
"菊糖","http://www.baike.com/wiki/菊糖","http://a0.att.hudong.com/72/85/20200000013920144736851207227_s.jpg","健康科学##分子生物学##化学品##有机物##科学##自然科学##药品##药学名词##药物中文名称列表","[药理作用] 诊断试剂 人体内不含菊糖，静注后，不被机体分解、结合、利用和破坏，经肾小球滤过，通过测定血中和尿中的菊糖含量，可以准确计算肾小球的滤过率。菊糖广泛存在于植物组织中,约有3.6万种植物中含有菊糖,尤其是菊芋、菊苣块根中含有丰富的菊糖[6,8]。菊芋(Jerusalem artichoke)又名洋姜,多年生草本植物,在我国栽种广泛,其适应性广、耐贫瘠、产量高、易种植,一般亩产菊芋块茎为2 000～4 000 kg,菊芋块茎除水分外,还含有15%～20%的菊糖,是加工生产菊糖及其制品的良好原料。","中文名：","菊糖"
"密度板","http://www.baike.com/wiki/密度板","http://a0.att.hudong.com/64/31/20200000013920144728317993941_s.jpg","居家##巧克力包装##应用科学##建筑材料##珠宝盒##礼品盒##科学##糖果盒##红酒盒##装修##装饰材料##隔断##首饰盒","密度板（英文：Medium Density Fiberboard (MDF)）也称纤维板，是以木质纤维或其他植物纤维为原料，施加脲醛树脂或其他适用的胶粘剂制成的人造板材。按其密度的不同，分为高密度板、中密度板、低密度板。密度板由于质软耐冲击，也容易再加工，在国外是制作家私的一种良好材料，但由于国家关于高密度板的标准比国际标准低数倍，所以，密度板在中国的使用质量还有待提高。","中文名：##全称：##别名：##主要材料：##分类：##优点：","密度板##中密度板纤维板##纤维板##以木质纤维或其他植物纤维##高密度板、中密度板、低密度板##表面光滑平整、材质细密性能稳定"
"煤气管道","http://www.baike.com/wiki/煤气管道","http://www.huimg.cn/entry/images/summary_default270x233.png","冶金术语","煤气管道，是用于运输煤气的管道，大多敷设在地下。城市煤气管网犹如城市的“血脉”，保障管网的安全运行至关重要。","",""
"釉柱","http://www.baike.com/wiki/釉柱","http://www.huimg.cn/entry/images/summary_default270x233.png","医学名词##组织学名词","釉柱（enamel rod）是牙釉质的基本结构。釉柱是细长的柱状结构，起自釉质牙本质界，贯穿全层达牙的表面。","",""
"浚渠","http://www.baike.com/wiki/浚渠","http://www.huimg.cn/entry/images/summary_default270x233.png","古文##文学##汉语##词语##语言","浚渠/浚渠 编辑 			 		jùn qú  释义/浚渠 编辑 			 		 深沟。   出处/浚渠 编辑 			 		元王祯 《农书》卷三：“如地势曲折而水远，则为槽架连筒阴沟浚渠陂栅之类，引而达之。”","名称：","浚渠"
```

可以看到每行是一个名词，包括：

* title：词语
* url：词语在互动百科的URL
* image：词语对应的照片的URL
* openTypeList：这个词语所属的分类，用 # 分隔
* detail：详细的描述信息
* baseInfoKeyList：基本信息key，用 # 分隔
* baseInfoValueList：基本信息value，用 # 分隔

#### attributes.csv

部分实体的属性（互动百科页面中直接得到）

其格式是这样的

```csv
Entity,AttributeName,Attribute
密度板,别名,纤维板
葡萄蔓枯病,主要为害部位,枝蔓
坎德拉,性别,男
坎德拉,国籍,法国
坎德拉,场上位置,后卫
转子莲,界,植物界
贝叶斯,出生地,伦敦
贝叶斯,国籍,英国
丁加,国籍,巴西
丁加,运动项目,足球
凌道扬,出生日期,1888年
凌道扬,性别,男
凌道扬,民族,汉族
凌道扬,国籍,中国
凌道扬,去世日期,1993年
大佛肚竹,界,植物界
```

比如对于其中的``坎德拉,国籍,法国``，理解为：坎德拉［实体］的国籍［属性］是法国［值］

## 源码分析

项目的目录结构是这样的，根据目录结构去大致了解这个KG项目的模块、功能

```
.
|--- MyCrawler           // Scrapy爬出项目路径（已爬好）
|    |--- MyCrawler
|         |--- data
|         |--- spiders
|
|--- data processing     // 数据清洗
|    |--- data
|
|--- demo                // django项目路径
|    |--- Model          // 模型层，用于封装Item类，以及neo4j和csv文件的读取
|    |--- demo           // 用于写页面的逻辑（View）
|    |--- label_data     // 标注训练集页面的保存路径
|         |--- handwork
|    |--- static         // 静态资源
|         |--- css
|         |--- js
|         |--- open-iconic
|    |--- templates      // html页面
|    |--- toolkit        // 工具类，包括预加载、命名实体识别
|    |--- KNN_predict
|
|--- predict label       // KNN算法预测标签
|--- dfs_tree_crawler    // 爬取互动百科农业实体树形结构的爬虫
|--- wikidataSpider      // 爬取wiki中的关系
```

